"use strict";(self["webpackChunkgiligili"]=self["webpackChunkgiligili"]||[]).push([[760],{7760:function(e,t,r){r.r(t),r.d(t,{default:function(){return d}});var s=function(){var e=this,t=e._self._c;return t("div",[t("h1",{staticStyle:{"text-align":"center"}},[e._v("登陆")]),t("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px","status-icon":"",rules:e.rules,"hide-required-asterisk":""}},[t("el-form-item",{attrs:{label:"用户名",prop:"username"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{type:"password",autocomplete:"off"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login.apply(null,arguments)}},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),t("el-form-item",[t("el-button",{attrs:{id:"button",type:"primary"},on:{click:e.login}},[e._v("登陆")]),t("el-button",{on:{click:e.toRegisterPage}},[e._v("去注册")])],1)],1)],1)},n=[],a=(r(7658),r(6369)),o=r(2900),i={data(){return{form:{username:"",password:""},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,max:30,message:"长度在 5 到 30 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:8,max:40,message:"长度在 8 到 40 个字符",trigger:"blur"}]}}},methods:{login(){let e=document.getElementById("button");!0!==e.disabled&&this.$refs["form"].validate((t=>{if(t){e.disabled=!0;let t=e.innerHTML;e.innerHTML="登陆中...",o.x4(this.form).then((r=>{if(0===r.code){let e=r.data.ip_location,t=`上次登陆IP属地：${e}`;""===e&&(t="这是您账户的第一次登陆"),localStorage.setItem("token",r.data.token),localStorage.setItem("refresh_token",r.data.refresh_token),localStorage.setItem("uid",r.data.id),this.$notify({title:"登陆成功",message:t,type:"success",showClose:!1}),this.$router.push("/")}else this.$notify.error({title:"登陆失败",message:r.msg,showClose:!1}),e.disabled=!1,e.innerHTML=t})).catch((r=>{this.$notify.error({title:"登陆失败",message:r,showClose:!1}),e.disabled=!1,e.innerHTML=t}))}else this.$notify.error({title:"登陆失败",message:"填入信息有误",showClose:!1})}))},toRegisterPage(){this.$router.push("/register")}},beforeMount(){a.a_()&&(this.$router.push("/me"),this.$notify.error({title:"拒绝访问",message:"你已登录",showClose:!1}))}},l=i,u=r(1001),m=(0,u.Z)(l,s,n,!1,null,null,null),d=m.exports},2900:function(e,t,r){r.d(t,{Gz:function(){return l},PR:function(){return i},gQ:function(){return m},gg:function(){return d},me:function(){return o},tb:function(){return u},x4:function(){return a},z2:function(){return n}});var s=r(196);const n=e=>s.Z.post("/api/v1/register",e).then((e=>e.data)),a=e=>s.Z.post("/api/v1/login",e).then((e=>e.data)),o=()=>s.Z.get("/api/v1/me").then((e=>e.data)),i=e=>s.Z.get(`/api/v1/user/${e}`).then((e=>e.data)),l=e=>s.Z.put("/api/v1/user/nickname",e).then((e=>e.data)),u=e=>s.Z.put("/api/v1/user/signature",e).then((e=>e.data)),m=e=>s.Z.put("/api/v1/user/password",e).then((e=>e.data)),d=e=>s.Z.post("/api/v1/user/avatar",e).then((e=>e.data))}}]);
//# sourceMappingURL=760.c9735750.js.map