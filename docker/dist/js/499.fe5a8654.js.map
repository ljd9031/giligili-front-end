{"version":3,"file":"js/499.fe5a8654.js","mappings":"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,MAAAA,IACA,cACA,YACA,eACAE,KAAAA,UACAR,QAAAA,SAEA,yCAEA,oBACArB,MAAAA,OACAqB,QAAAA,EAAAA,IACAS,WAAAA,IAEAJ,EAAAA,UAAAA,EACAA,EAAAA,UAAAA,EACA,qBACA,0BACA,IACA,WACA,oBACA1B,MAAAA,OACAqB,QAAAA,EACAS,WAAAA,IAEAJ,EAAAA,UAAAA,EACAA,EAAAA,UAAAA,EACA,qBACA,4BAEA,MApDA,oBACA1B,MAAAA,OACAqB,QAAAA,SACAS,WAAAA,GAiDA,GAEA,EACA1B,WACA,gCACA,EACAF,YAAAA,GACA,sBACA,EACAC,kBAAAA,GACA,8BACA,oCACA,EAGA,EACAE,cAAAA,GACA,sBACA,mBAEA,EACAE,YAAAA,GACA,sBACA,EACAC,kBAAAA,GACA,iCACA,oCACA,EAGA,EACAC,cAAAA,GACA,wBACA,mBAEA,EACAH,eACA,2BACA,eACAe,QAAAA,YACAQ,KAAAA,aAEA,EAGA,GAEAE,cACA,4BACA,mBACA,oBACA/B,MAAAA,OACAqB,QAAAA,OACAS,WAAAA,SAEA,wBAGA,iEACA,oBACA9B,MAAAA,OACAqB,QAAAA,UACAS,WAAAA,SAEA,yBAGA,eACA,8CACA,wCACA,GC/L2P,I,UCOvPE,GAAY,OACd,EACAlD,EACAkC,GACA,EACA,KACA,KACA,MAIF,EAAegB,EAAiB,O","sources":["webpack://giligili/./src/views/UpdateVideo.vue","webpack://giligili/src/views/UpdateVideo.vue","webpack://giligili/./src/views/UpdateVideo.vue?006e","webpack://giligili/./src/views/UpdateVideo.vue?e8b5"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('h1',{staticStyle:{\"text-align\":\"center\"}},[_vm._v(\"更新视频\")]),_c('el-form',{ref:\"form\",attrs:{\"model\":_vm.form,\"label-width\":\"80px\",\"status-icon\":\"\",\"rules\":_vm.rules,\"hide-required-asterisk\":\"\"}},[_c('el-form-item',{attrs:{\"label\":\"视频ID\"}},[_c('el-input',{attrs:{\"disabled\":true},model:{value:(_vm.form.id),callback:function ($$v) {_vm.$set(_vm.form, \"id\", $$v)},expression:\"form.id\"}})],1),_c('el-form-item',{attrs:{\"label\":\"标题\",\"prop\":\"title\"}},[_c('el-input',{attrs:{\"autocomplete\":\"off\"},model:{value:(_vm.form.title),callback:function ($$v) {_vm.$set(_vm.form, \"title\", $$v)},expression:\"form.title\"}})],1),_c('el-form-item',{attrs:{\"label\":\"简介\",\"prop\":\"info\"}},[_c('el-input',{attrs:{\"type\":\"textarea\",\"autocomplete\":\"off\"},model:{value:(_vm.form.info),callback:function ($$v) {_vm.$set(_vm.form, \"info\", $$v)},expression:\"form.info\"}})],1),_c('el-form-item',{attrs:{\"label\":\"封面\"}},[_c('el-upload',{attrs:{\"action\":\"\",\"http-request\":_vm.uploadCover,\"before-upload\":_vm.beforeUploadCover,\"on-exceed\":_vm.onExceed,\"on-remove\":_vm.onRemoveCover,\"before-remove\":_vm.beforeRemove,\"limit\":1,\"accept\":\".jpg,.jpeg,.png\"}},[_c('el-button',{attrs:{\"size\":\"mini\"}},[_vm._v(\"选择封面\")])],1)],1),_c('el-form-item',{attrs:{\"label\":\"视频\"}},[_c('el-upload',{attrs:{\"action\":\"\",\"http-request\":_vm.uploadVideo,\"before-upload\":_vm.beforeUploadVideo,\"on-exceed\":_vm.onExceed,\"on-remove\":_vm.onRemoveVideo,\"before-remove\":_vm.beforeRemove,\"limit\":1,\"accept\":\".mp4\"}},[_c('el-button',{attrs:{\"size\":\"mini\"}},[_vm._v(\"选择视频\")])],1)],1),_c('el-form-item',[(_vm.showProgress)?_c('span',{staticStyle:{\"color\":\"#606266\"}},[_vm._v(\"上传中，过程可能较慢，请勿关闭页面或操作被上传的文件; 在token刷新时可能会造成进度条不动，此时属于正常现象\")]):_vm._e(),(_vm.showProgress)?_c('el-progress',{attrs:{\"percentage\":_vm.progressPercentage}}):_vm._e(),_c('el-button',{attrs:{\"id\":\"button\",\"type\":\"primary\"},on:{\"click\":_vm.updatevideo}},[_vm._v(\"更新\"),_c('i',{staticClass:\"el-icon-upload el-icon--right\"})])],1)],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div>\n        <h1 style=\"text-align:center\">更新视频</h1>\n        <el-form ref=\"form\" :model=\"form\" label-width=\"80px\" status-icon :rules=\"rules\" hide-required-asterisk>\n            <el-form-item label=\"视频ID\">\n                <el-input v-model=\"form.id\" :disabled=\"true\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"标题\" prop=\"title\">\n                <el-input v-model=\"form.title\" autocomplete=\"off\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"简介\" prop=\"info\">\n                <el-input type=\"textarea\" v-model=\"form.info\" autocomplete=\"off\"></el-input>\n            </el-form-item>\n            <el-form-item label=\"封面\">\n                <el-upload action=\"\" :http-request=\"uploadCover\" :before-upload=\"beforeUploadCover\"\n                    :on-exceed=\"onExceed\" :on-remove=\"onRemoveCover\" :before-remove=\"beforeRemove\" :limit=\"1\"\n                    accept=\".jpg,.jpeg,.png\">\n                    <el-button size=\"mini\">选择封面</el-button>\n                </el-upload>\n            </el-form-item>\n            <el-form-item label=\"视频\">\n                <el-upload action=\"\" :http-request=\"uploadVideo\" :before-upload=\"beforeUploadVideo\"\n                    :on-exceed=\"onExceed\" :on-remove=\"onRemoveVideo\" :before-remove=\"beforeRemove\" :limit=\"1\"\n                    accept=\".mp4\">\n                    <el-button size=\"mini\">选择视频</el-button>\n                </el-upload>\n            </el-form-item>\n            <el-form-item>\n                <span v-if=\"showProgress\" style=\"color: #606266;\">上传中，过程可能较慢，请勿关闭页面或操作被上传的文件;\n                    在token刷新时可能会造成进度条不动，此时属于正常现象</span>\n                <el-progress v-if=\"showProgress\" :percentage=\"progressPercentage\"></el-progress>\n                <el-button id=\"button\" type=\"primary\" @click=\"updatevideo\">更新<i\n                        class=\"el-icon-upload el-icon--right\"></i>\n                </el-button>\n            </el-form-item>\n        </el-form>\n    </div>\n</template>\n  \n<script>\nimport * as API from '@/api/video'\n\nexport default {\n    data() {\n        return {\n            form: {\n                id: '',\n                title: '',\n                info: '',\n                cover: '',\n                video: '',\n            },\n            progressPercentage: 0,\n            showProgress: false,\n            rules: {\n                title: [\n                    { required: true, message: '请输入标题', trigger: 'blur' },\n                    { min: 2, max: 30, message: '长度在 2 到 30 个字符', trigger: 'blur' }\n                ],\n                info: [\n                    { max: 255, message: '长度需小于等于255个字符', trigger: 'blur' }\n                ],\n            }\n        }\n    },\n    methods: {\n        updatevideo() {\n            this.$refs['form'].validate((valid) => {\n                if (!valid) {\n                    this.$notify.error({\n                        title: '更新失败',\n                        message: '填入信息有误',\n                        showClose: false\n                    });\n                } else {\n                    let form = new FormData()\n                    form.append(\"title\", this.form.title)\n                    form.append(\"info\", this.form.info)\n                    if (this.form.cover !== '') {\n                        form.append(\"cover\", this.form.cover)\n                    }\n                    if (this.form.video !== '') {\n                        form.append(\"video\", this.form.video)\n                    }\n                    let button = document.getElementById(\"button\")\n                    button.disabled = true\n                    let preInner = button.innerHTML\n                    button.innerHTML = \"更新中...\"\n                    let _this = this\n                    _this.showProgress = true\n                    API.updateVideo(this.form.id, form, function (e) {\n                        _this.progressPercentage = parseInt(e.loaded / e.total * 100)\n                    }).then((res) => {\n                        if (res.code === 0) {\n                            this.$message({\n                                type: 'success',\n                                message: '更新成功'\n                            });\n                            this.$router.push('/video/' + res.data.id)\n                        } else {\n                            this.$notify.error({\n                                title: '更新失败',\n                                message: res.msg,\n                                showClose: false\n                            });\n                            button.disabled = false\n                            button.innerHTML = preInner\n                            this.showProgress = false\n                            this.progressPercentage = 0\n                        }\n                    }).catch((error) => {\n                        this.$notify.error({\n                            title: '更新失败',\n                            message: error,\n                            showClose: false\n                        });\n                        button.disabled = false\n                        button.innerHTML = preInner\n                        this.showProgress = false\n                        this.progressPercentage = 0\n                    });\n                }\n            });\n        },\n        onExceed() {\n            this.$message.warning(\"文件只能为1个\")\n        },\n        uploadCover(option) {\n            this.form.cover = option.file\n        },\n        beforeUploadCover(file) {\n            if (file.size / 1024 / 1024 > 2) {\n                this.$message.error('封面大小不能超过2MB');\n                return false\n            }\n            return true\n        },\n        onRemoveCover(file) {\n            if (file.size / 1024 / 1024 <= 2) { //封面大小超过2MB时会自动触发移除钩子\n                this.form.cover = \"\"\n            }\n        },\n        uploadVideo(option) {\n            this.form.video = option.file\n        },\n        beforeUploadVideo(file) {\n            if (file.size / 1024 / 1024 > 1024) {\n                this.$message.error('视频大小不能超过1GB');\n                return false\n            }\n            return true\n        },\n        onRemoveVideo(file) {\n            if (file.size / 1024 / 1024 <= 100) { //视频大小超过1GB时会自动触发移除钩子\n                this.form.video = \"\"\n            }\n        },\n        beforeRemove() {\n            if (this.showProgress) {\n                this.$message({\n                    message: '上传时禁止移除文件',\n                    type: 'warning'\n                });\n                return false\n            }\n            return true\n        },\n    },\n    beforeMount() {\n        let id = this.$route.params.id\n        if (id === undefined) {\n            this.$notify.error({\n                title: \"拒绝访问\",\n                message: \"非法操作\",\n                showClose: false\n            });\n            this.$router.push('/')\n            return\n        }\n        if (this.$route.params.uid.toString() !== localStorage.getItem(\"uid\")) {\n            this.$notify.error({\n                title: \"拒绝访问\",\n                message: \"该视频不属于你\",\n                showClose: false\n            });\n            this.$router.push('/')\n            return\n        }\n        this.form.id = id\n        this.form.title = this.$route.params.title\n        this.form.info = this.$route.params.info\n    }\n}\n</script>\n  ","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./UpdateVideo.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./UpdateVideo.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UpdateVideo.vue?vue&type=template&id=5b9405d8&\"\nimport script from \"./UpdateVideo.vue?vue&type=script&lang=js&\"\nexport * from \"./UpdateVideo.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticStyle","_v","ref","attrs","form","rules","model","value","id","callback","$$v","$set","expression","title","info","uploadCover","beforeUploadCover","onExceed","onRemoveCover","beforeRemove","uploadVideo","beforeUploadVideo","onRemoveVideo","showProgress","_e","progressPercentage","on","updatevideo","staticClass","staticRenderFns","data","cover","video","required","message","trigger","min","max","methods","button","_this","API","type","showClose","beforeMount","component"],"sourceRoot":""}